<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    
    <style>
        img{
            margin :0;
            display: none;
        }

    </style>
</head>
<body>
    <canvas id="monSuperCanvas"></canvas>
   
</body>
<script src="./lib/Easeljs-1.0.0//lib/easeljs-NEXT.min.js"></script>
<script src="./preloadjs.min.js"></script>
<script>
    // loading all assets
    var Q = new createjs.LoadQueue();
    Q.on("complete",completeLoading,this);
    // Image
    Q.loadManifest([
        {id:"T1",src:"./Asset/tuile/tuileTest1.png"},
        {id:"T2",src:"./Asset/tuile/tuileTest2.png"},
        {id:"T3",src:"./Asset/tuile/tuileTest3.png"},
        {id:"T4",src:"./Asset/tuile/tuileTest4.png"},
        {id:"T5",src:"./Asset/tuile/tuileTest5.png"},
        {id:"T6",src:"./Asset/tuile/tuileTest6.png"},
        {id:"T7",src:"./Asset/tuile/tuileTest7.png"},
        {id:"T8",src:"./Asset/tuile/tuileTest8.png"},
        {id:"T9",src:"./Asset/tuile/tuileTest9.png"},
        {id:"T10",src:"./Asset/tuile/tuileTest10.png"},
        {id:"T11",src:"./Asset/tuile/tuileTest11.png"}
        
    ]);
    // Sound
    

    // variable
    var canevas;
    var scene;
    var back;
    var hPosTuile1;
    var hPosTuile2;
    var tuile1;
    var tuile2;
    var idInterval
    var idNextTuile;
    var boolGameBegin=false;
    var ConstImageHeight;

    function completeLoading(event){
        initGame();
        idInterval = window.setInterval(update,1);
    }


    function initGame(){
        // init canevas
        canvas = document.getElementById("monSuperCanvas");
        canvas.width= window.innerWidth;
        canvas.height= window.innerHeight;
        scene = new createjs.Stage("monSuperCanvas");
        back = new createjs.Shape();
        // init tuile1
        tuile1 = new createjs.Bitmap(Q.getResult("T1"));
        hPosTuile1 = 0;
        ConstImageHeight = Q.getResult("T1").height;
        // init tuile2
        tuile2 = new createjs.Bitmap(Q.getResult("T2"));
        hPosTuile2 = -Q.getResult("T2").height;
        console.log(ConstImageHeight)
        idNextTuile=3;

        // adding in scene
        scene.addChild(tuile1);
        scene.addChild(tuile2);
        

    }

    function update(){
        if(boolGameBegin == true){
            hPosTuile1+=1;
            hPosTuile2+=1;
            //console.log(hPosTuile2,hPosTuile1);
            hPosTuile1 = ResetTuileUp(tuile1,hPosTuile1);
            hPosTuile2 = ResetTuileUp(tuile2,hPosTuile2);
        }
        tuile2.setTransform(0,hPosTuile2);
        tuile1.setTransform(0,hPosTuile1);
        
        scene.update();
        if(idNextTuile > 10){
            boolGameBegin = false;
        }
    }

    

    function ResetTuileUp(tuile,positionH){
        if(positionH> canvas.height){
            // note : 1 mettre la taille au min et 2 changer la tuile hors de l'ecran
            console.log("ETAT",positionH,canvas.height,tuile.image.height);
            positionH = -ConstImageHeight; // test taille min entre les deux
            tuile.image = Q.getResult("T"+idNextTuile);
            idNextTuile++;
            //boolGameBegin=false;
        }
        return positionH;
    }

    // TODO 
    function ResizeAuto(){

    }
</script>
</html>